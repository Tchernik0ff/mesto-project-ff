(()=>{"use strict";var e={454:(e,t,n)=>{e.exports=n.p+"5aca1524c9fb4773ad49.jpg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href,(()=>{function e(e){document.addEventListener("keyup",o),document.addEventListener("click",r),e.classList.add("popup_is-opened")}function t(e){document.removeEventListener("keyup",o),document.removeEventListener("click",r),e.classList.remove("popup_is-opened")}function o(e){var n=document.querySelector(".popup_is-opened");"Escape"===e.code&&n&&t(n)}function r(e){var n=document.querySelector(".popup_is-opened");e.target.classList.contains("popup_is-opened")&&!e.target.classList.contains("popup_content")&&t(n)}var c={baseUrl:"https://nomoreparties.co/v1/wff-cohort-16",headers:{authorization:"57108712-c7d4-4893-a583-03b34dde65b3","Content-Type":"application/json"}},a=fetch("".concat(c.baseUrl,"/cards "),{headers:c.headers}),u=document.querySelector("#card-template").content;function i(e){e.target.classList.toggle("card__like-button_is-active"),function(e){var t=e.target.closest(".card").getAttribute("data-id");e.target.classList.contains("card__like-button_is-active")?function(e){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:c.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(t).then((function(t){e.target.classList.add("card__like-button_is-active"),e.target.parentElement.querySelector(".like-counter").textContent=t.likes.length})).catch((function(e){console.error("Произошла ошибка:",e)})):function(e){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:c.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(t).then((function(t){e.target.classList.remove("card__like-button_is-active"),e.target.parentElement.querySelector(".like-counter").textContent=t.likes.length})).catch((function(e){console.log("Произошла ошибка:",e)}))}(e)}function s(e){var t,n=e.target.closest(".places__item");(t=n.getAttribute("data-id"),fetch("".concat(c.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:c.headers}).then((function(e){return e.json()}))).then((function(){n.remove()})).catch((function(e){console.log("Произошла ошибка при удалении карточки:",e)}))}function l(){var e=new URL(n(454),n.b);this.src=e}var d={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function p(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.classList.add(o.errorClass),r.textContent=n}function f(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}function _(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove(n.inactiveButtonClass)):(t.setAttribute("disabled",!0),t.classList.add(n.inactiveButtonClass))}var m=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){f(e,n,t)})),_(n,o,t)},v=document.querySelector(".popup_type_edit"),y=document.querySelector('[name="edit-profile"]'),h=y.querySelector(".popup__button"),S=document.querySelector(".profile__title"),b=document.querySelector(".profile__description"),q=document.querySelector(".profile__edit-button"),g=document.querySelector(".profile__image"),L=document.querySelector(".popup_type_avatar"),k=document.querySelector('[name="new-avatar"]'),E=k.querySelector(".popup__button"),C=document.querySelector(".popup__input_type_ava"),x=document.querySelector(".popup_type_new-card"),j=x.querySelector(".popup__button"),A=document.querySelector(".profile__add-button"),U=document.querySelector('[name="new-place"]'),P=document.querySelector(".popup_type_image"),w=P.querySelector(".popup__image"),T=P.querySelector(".popup__caption"),B=document.querySelector(".places__list"),O=document.querySelector(".popup__input_type_name"),D=document.querySelector(".popup__input_type_description"),N=document.querySelectorAll(".popup__close"),I=document.querySelectorAll(".popup");function J(t){if(t.target.classList.contains("card__image")){var n=t.target.src,o=t.target.alt,r=t.target.closest(".card").querySelector(".card__title").textContent;T.textContent=r,w.src=n,w.alt=o,e(P)}}function M(e,t,n,o,r,c,a,i){var s=function(e,t,n,o,r,c,a,i){var s=u.cloneNode(!0),d=s.querySelector(".card__delete-button"),p=s.querySelector(".card__image"),f=s.querySelector(".card__title"),_=s.querySelector(".card__like-button"),m=s.querySelector(".like-counter");return s.querySelector(".card").setAttribute("data-id",i),p.src=t,p.alt=e,m.textContent=c.length,p.onerror=l,f.textContent=e,"42c4fefa56069aac06601143"!==a?d.style.display="none":d.addEventListener("click",n),_.addEventListener("click",o),p.addEventListener("click",r),c.forEach((function(e){"42c4fefa56069aac06601143"===e._id&&_.classList.add("card__like-button_is-active")})),s}(e,t,n,o,r,c,a,i);x.classList.contains("popup_is-opened")?B.prepend(s):B.append(s)}!function(e,t,n){fetch("".concat(c.baseUrl,"/users/me "),{headers:c.headers}).then((function(e){return e.json()})).then((function(o){e.textContent=o.name,t.textContent=o.about,n.style.backgroundImage="url(".concat(o.avatar,")")})).catch((function(e){console.error("Ошибка получения данных:",e)}))}(S,b,g),Promise.all([a]).then((function(e){return Promise.all(e.map((function(e){return e.json()})))})).then((function(e){e[0].forEach((function(e){M(e.name,e.link,s,i,J,e.likes,e.owner._id,e._id)}))})).catch((function(e){console.error("Произошла ошибка при загрузке данных:",e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?f(e,t,n):t.validity.patternMismatch?p(e,t,t.dataset.errorMessage,n):p(e,t,t.validationMessage,n)}(e,r,t),_(n,o,t)}))}))}(t,e)}))}(d),I.forEach((function(e){e.classList.add("popup_is-animated")})),g.addEventListener("click",(function(){e(L),k.reset(),m(k,d)})),q.addEventListener("click",(function(){e(v),O.value=S.textContent,D.value=b.textContent,m(y,d)})),A.addEventListener("click",(function(){e(x)})),U.addEventListener("submit",(function(e){e.preventDefault(),j.textContent="Сохранить...";var n,o,r=document.querySelector(".popup__input_type_card-name").value,a=document.querySelector(".popup__input_type_url").value;(n=r,o=a,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:n,link:o})}).then((function(e){return e.json()}))).then((function(e){var n=e.likes,o=e.owner._id,c=e._id;M(r,a,s,i,J,n,o,c),t(x),U.reset(),m(U,d),j.textContent="Сохранить"})).catch((function(e){console.log("Не удалось добавить карточку на сервер",e)}))})),y.addEventListener("submit",(function(e){var n,o,r,a;e.preventDefault(),n=O.value,o=D.value,a=function(){S.textContent=O.value,b.textContent=D.value,t(v)},(r=h).textContent="Сохранение...",fetch("".concat(c.baseUrl,"/users/me"),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:n,about:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){r.textContent="Сохранить",a()})).catch((function(e){console.error("Ошибка обновления данных:",e)}))})),k.addEventListener("submit",(function(e){e.preventDefault(),function(e,n,o,r){o.textContent="Сохранение...",fetch("".concat(c.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){n.style.backgroundImage="url(".concat(e.avatar,")"),o.textContent="Сохранить",t(L)})).catch((function(e){o.textContent="Сохраненить",console.error("Ошибка обновления аватара:",e)}))}(C.value,g,E)})),N.forEach((function(e){var n=e.closest(".popup");e.addEventListener("click",(function(){t(n)}))}))})()})();